<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="966px" preserveAspectRatio="none" style="width:1524px;height:966px;" version="1.1" viewBox="0 0 1524 966" width="1524px" zoomAndPan="magnify"><defs><filter height="300%" id="feo774meml66j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="501.5902" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="251.5" y="356.716"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="438.1782" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="426.5" y="388.4221"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="406.4722" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="663.5" y="420.1281"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="333.0602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="822.5" y="493.5401"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="768.2384" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1074.5" y="99.0679"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="768.2384" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1306.5" y="99.0679"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="51.412" style="stroke: #000000; stroke-width: 2.0;" width="373.5" x="1039.5" y="228.892"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="146.5301" style="stroke: #000000; stroke-width: 2.0;" width="1106.5" x="13" y="508.5401"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="45" x2="45" y1="89.0679" y2="876.3063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="256" x2="256" y1="89.0679" y2="876.3063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="431" x2="431" y1="89.0679" y2="876.3063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="668" x2="668" y1="89.0679" y2="876.3063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="827.5" x2="827.5" y1="89.0679" y2="876.3063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1079.5" x2="1079.5" y1="89.0679" y2="876.3063"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1311" x2="1311" y1="89.0679" y2="876.3063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="23" y="84.9659">Client</text><ellipse cx="45.5" cy="13" fill="#FEFECE" filter="url(#feo774meml66j)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M45.5,21 L45.5,48 M32.5,29 L58.5,29 M45.5,48 L32.5,63 M45.5,48 L58.5,63 " fill="none" filter="url(#feo774meml66j)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="23" y="890.2722">Client</text><ellipse cx="45.5" cy="904.3742" fill="#FEFECE" filter="url(#feo774meml66j)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M45.5,912.3742 L45.5,939.3742 M32.5,920.3742 L58.5,920.3742 M45.5,939.3742 L32.5,954.3742 M45.5,939.3742 L58.5,954.3742 " fill="none" filter="url(#feo774meml66j)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="65" x="222" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="229" y="72.9659">Uvicorn</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="65" x="222" y="875.3063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="229" y="897.2722">Uvicorn</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="394" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="401" y="72.9659">Starlette</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="394" y="875.3063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="401" y="897.2722">Starlette</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="620" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="627" y="72.9659">FastAPI app</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="620" y="875.3063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="627" y="897.2722">FastAPI app</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="756.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="763.5" y="72.9659">SendTemp Thread</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="756.5" y="875.3063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="763.5" y="897.2722">SendTemp Thread</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1049.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1056.5" y="72.9659">Buffer</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="1049.5" y="875.3063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="1056.5" y="897.2722">Buffer</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1220" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1227" y="72.9659">PeriodicMeasure Thread</text><rect fill="#FEFECE" filter="url(#feo774meml66j)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1220" y="875.3063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1227" y="897.2722">PeriodicMeasure Thread</text><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="501.5902" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="251.5" y="356.716"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="438.1782" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="426.5" y="388.4221"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="406.4722" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="663.5" y="420.1281"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="333.0602" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="822.5" y="493.5401"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="768.2384" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1074.5" y="99.0679"/><rect fill="#FFFFFF" filter="url(#feo774meml66j)" height="768.2384" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1306.5" y="99.0679"/><rect fill="#EEEEEE" filter="url(#feo774meml66j)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1509" x="3" y="120.9209"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1512" y1="120.9209" y2="120.9209"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1512" y1="123.9209" y2="123.9209"/><rect fill="#EEEEEE" filter="url(#feo774meml66j)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="156" x="679.5" y="109.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="685.5" y="126.9649">Hintergrundprozesse</text><path d="M1321,149.7739 L1321,212.7739 L1503,212.7739 L1503,159.7739 L1493,149.7739 L1321,149.7739 " fill="#FBFB77" filter="url(#feo774meml66j)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1493,149.7739 L1493,159.7739 L1503,159.7739 L1493,149.7739 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="1327" y="168.6709">läuft endlos,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="1327" y="186.377">liest I2C-Temperatursensor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1327" y="204.083">und überschreibt Buffer</text><path d="M1039.5,228.892 L1112.5,228.892 L1112.5,237.892 L1102.5,247.892 L1039.5,247.892 L1039.5,228.892 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="51.412" style="stroke: #000000; stroke-width: 2.0;" width="373.5" x="1039.5" y="228.892"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="1054.5" y="243.789">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="1127.5" y="242.6509">[forever]</text><polygon fill="#A80036" points="1095.5,268.304,1085.5,272.304,1095.5,276.304,1091.5,272.304" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1089.5" x2="1305.5" y1="272.304" y2="272.304"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="1101.5" y="266.495">update(timestamp, temperature)</text><rect fill="#EEEEEE" filter="url(#feo774meml66j)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1509" x="3" y="309.157"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1512" y1="309.157" y2="309.157"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1512" y1="312.157" y2="312.157"/><rect fill="#EEEEEE" filter="url(#feo774meml66j)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="171" x="672" y="297.304"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="678" y="315.201">WebSocket-Verbindung</text><polygon fill="#A80036" points="239.5,352.716,249.5,356.716,239.5,360.716,243.5,356.716" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="45.5" x2="245.5" y1="356.716" y2="356.716"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="52.5" y="350.907">WS CONNECT /ws/temperature</text><polygon fill="#A80036" points="414.5,384.4221,424.5,388.4221,414.5,392.4221,418.5,388.4221" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="261.5" x2="420.5" y1="388.4221" y2="388.4221"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="268.5" y="382.6131">ASGI receive scope</text><polygon fill="#A80036" points="651.5,416.1281,661.5,420.1281,651.5,424.1281,655.5,420.1281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="436.5" x2="657.5" y1="420.1281" y2="420.1281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="443.5" y="414.3191">websocket_route /ws/temperature</text><path d="M678,433.1281 L678,460.1281 L921,460.1281 L921,443.1281 L911,433.1281 L678,433.1281 " fill="#FBFB77" filter="url(#feo774meml66j)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M911,433.1281 L911,443.1281 L921,443.1281 L911,433.1281 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="684" y="452.0251">bei connect: starte SendTemp Thread</text><polygon fill="#A80036" points="810.5,489.5401,820.5,493.5401,810.5,497.5401,814.5,493.5401" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="673.5" x2="816.5" y1="493.5401" y2="493.5401"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="680.5" y="487.7311">start(temp_measure)</text><path d="M13,508.5401 L86,508.5401 L86,517.5401 L76,527.5401 L13,527.5401 L13,508.5401 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="146.5301" style="stroke: #000000; stroke-width: 2.0;" width="1106.5" x="13" y="508.5401"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="28" y="523.4371">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="101" y="522.299">[every 30 seconds]</text><polygon fill="#A80036" points="1062.5,547.9521,1072.5,551.9521,1062.5,555.9521,1066.5,551.9521" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="832.5" x2="1068.5" y1="551.9521" y2="551.9521"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="839.5" y="546.1431">read latest(timestamp, temperature)</text><polygon fill="#A80036" points="684.5,579.6582,674.5,583.6582,684.5,587.6582,680.5,583.6582" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="678.5" x2="821.5" y1="583.6582" y2="583.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="690.5" y="577.8492">temp_measure(data)</text><polygon fill="#A80036" points="272.5,611.3642,262.5,615.3642,272.5,619.3642,268.5,615.3642" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="266.5" x2="662.5" y1="615.3642" y2="615.3642"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="278.5" y="609.5552">ASGI send websocket message</text><polygon fill="#A80036" points="56.5,643.0702,46.5,647.0702,56.5,651.0702,52.5,647.0702" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="50.5" x2="250.5" y1="647.0702" y2="647.0702"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="62.5" y="641.2612">WebSocket MESSAGE</text><rect fill="#EEEEEE" filter="url(#feo774meml66j)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1509" x="3" y="683.9232"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1512" y1="683.9232" y2="683.9232"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1512" y1="686.9232" y2="686.9232"/><rect fill="#EEEEEE" filter="url(#feo774meml66j)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="133" x="691" y="672.0702"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="697" y="689.9672">Verbindungsende</text><polygon fill="#A80036" points="239.5,727.4822,249.5,731.4822,239.5,735.4822,243.5,731.4822" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="45.5" x2="245.5" y1="731.4822" y2="731.4822"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="52.5" y="725.6732">WS CLOSE</text><polygon fill="#A80036" points="414.5,759.1882,424.5,763.1882,414.5,767.1882,418.5,763.1882" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="261.5" x2="420.5" y1="763.1882" y2="763.1882"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="268.5" y="757.3792">ASGI receive disconnect</text><polygon fill="#A80036" points="651.5,790.8943,661.5,794.8943,651.5,798.8943,655.5,794.8943" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="436.5" x2="657.5" y1="794.8943" y2="794.8943"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="443.5" y="789.0853">websocket_disconnect</text><polygon fill="#A80036" points="815.5,822.6003,825.5,826.6003,815.5,830.6003,819.5,826.6003" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="668.5" x2="821.5" y1="826.6003" y2="826.6003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="675.5" y="820.7913">stop()</text><polygon fill="#A80036" points="56.5,854.3063,46.5,858.3063,56.5,862.3063,52.5,858.3063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="50.5" x2="255.5" y1="858.3063" y2="858.3063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="62.5" y="852.4973">WS CLOSE</text><!--MD5=[af72f0637726bd8b95888321f3154159]
@startuml
actor Client
participant Uvicorn
participant Starlette
participant FastAPIApp as "FastAPI app"
participant "SendTemp Thread" as SendThread
participant Buffer
participant "PeriodicMeasure Thread" as PeriodicThread

== Hintergrundprozesse ==
activate PeriodicThread
activate Buffer
note right of PeriodicThread
  läuft endlos,
  liest I2C-Temperatursensor
  und überschreibt Buffer
end note
loop forever
    PeriodicThread -> Buffer: update(timestamp, temperature)
end

== WebSocket-Verbindung ==
Client -> Uvicorn: WS CONNECT /ws/temperature
activate Uvicorn
Uvicorn -> Starlette: ASGI receive scope
activate Starlette
Starlette -> FastAPIApp: websocket_route /ws/temperature
activate FastAPIApp
note right of FastAPIApp
  bei connect: starte SendTemp Thread
end note
FastAPIApp -> SendThread: start(temp_measure)
activate SendThread

loop every 30 seconds
    SendThread -> Buffer: read latest(timestamp, temperature)
    SendThread -> FastAPIApp: temp_measure(data)
    FastAPIApp -> Uvicorn: ASGI send websocket message
    Uvicorn - -> Client: WebSocket MESSAGE
end

== Verbindungsende ==
Client - -> Uvicorn: WS CLOSE
Uvicorn -> Starlette: ASGI receive disconnect
Starlette -> FastAPIApp: websocket_disconnect
FastAPIApp -> SendThread: stop()
deactivate SendThread
deactivate FastAPIApp
deactivate Starlette
Uvicorn - -> Client: WS CLOSE
deactivate Uvicorn
@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.7+6-Ubuntu-0ubuntu124.04
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>